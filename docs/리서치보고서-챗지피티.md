
# 📊 진단 의료용 X-ray Console SW 개발 종합 리서치 보고서

**작성일:** 2026‑02‑17  
**목적:** X‑ray 검출기와 연동되는 진단 의료용 X‑ray Console SW 개발을 위한 종합 기술 리서치  
**대상:** 소프트웨어 아키텍처 설계 및 전체 시스템 통합

## 🔎 Executive Summary (총괄 요약)

진단 의료용 X‑ray Console SW는 **하드웨어(Detector, X‑ray Generator, AEC, Table/Collimator)**와 **병원 IT 인프라(PACS/HIS/RIS)**를 통합하는 워크플로우 중심의 SW 시스템입니다. 본 리서치는 SW 개발의 기술적 요구 사항, 디바이스 통합, DICOM/IHE 표준 연동 및 인허가 전략을 고려하여 다음 영역을 체계적으로 다루었습니다:

- Console SW의 기능 구성과 아키텍처
- GUI 및 기술 스택 비교 분석
- 핵심 라이브러리/도구와 HW 인터페이스 요건
- 의료기기 규제·표준과 인허가 전략
- 디바이스(Detector, HVG 등) 연동 리서치
- 시스템 통합, 검증, 테스트 전략
- 리스크 관리 및 다음 단계 전략

---

## 1. 🧠 X‑ray Console SW 개요
### 1.1 역할과 목표

X‑ray Console SW는 획득 → 처리 → QC → 저장/전송의 전체 워크플로우를 GUI 기반으로 제어하는 역할을 합니다. 주요 목적은 다음과 같습니다:

- 실시간 영상 획득 및 프리뷰
- 프로토콜 기반 체계적 촬영
- DICOM/IHE 기반 병원 시스템 연동
- 환자 정보 및 검사 관리
- 정확한 선량/Dose 보고 및 기록

---

## 2. 🧩 Console 기능 구조


다음은 콘솔이 반드시 포함해야 하는 기능 블록입니다:

| 기능영역           | 상세 기능 |
|-------------------|-------------------------------------------------------------|
| 환자/검사 관리    | Worklist 처리, 응급/수기 등록, Procedure Code 매핑 |
| 프로토콜/파라미터 | Bodypart/Projection preset, kVp/mAs/FSS/SID 설정 |
| 영상 획득 & 처리  | Gain/Offset, Noise reduction, Flattening, VGrid, Window/Level |
| Generator & AEC 제어 | X‑ray 케이싱 제어, 자동/수동 노출 설정 |
| 프리뷰 & QC       | 즉시 영상 확인, Reject/Accept, 처리 옵션 |
| DICOM 통신        | MWL, C‑STORE, MPPS, Dose SR, Q/R |
| 뷰어 & 기초 판독  | Win/Level, Zoom, Pan, Measurements |
| 시스템 설정       | Calibration, 사용자/네트워크 설정, 로그/보안 관리 |

---

## 3. 🏛️ SW 아키텍처
### 3.1 계층 구조

콘솔 SW의 핵심은 **다양한 하드웨어 장치 (Detector, HVG 등)**를 유연하게 연결할 수 있는 계층형 아키텍처입니다. 하드웨어 추상화 레이어와 플러그인 기반 설계를 통해 다양한 제조사 장비와의 호환성을 보장합니다.


```
┌─────────────────────────────────────────────────────────────┐
│                        Console SW (Host PC)                │
│  ┌───────────┐ ┌────────────┐ ┌────────────┐ ┌──────────────┐│
│  │ GUI Layer │ │ Core Logic │ │ DICOM/IHE  │ │ Device Layer ││
│  │ (WPF/Qt)  │ │ (Workflow) │ │  Service   │ │  (Drivers)   ││
│  └─────┬─────┘ └─────┬──────┘ └──────┬─────┘ └──────┬───────┘│
│        |                  |                  |               │
│  ┌─────▼────┐     ┌───────▼───────┐  ┌─────▼────┐           │
│  | PACS     |     | HIS/RIS       |  | DVTK/    |  ┌───────┐│
│  └──────────┘     └───────────────┘  | Orthanc  |  |HW Layer││
│                                            ▲       ·Detector││
│                                            |       · HVG    ││
│                                            |       ·Collimator││
└──────────────────────────────────────────────────────────────┘
```


---

## 4. 🖼 GUI 및 프레임워크 비교

### 주요 후보

| 항목             | Qt (C++)              | WPF (C#/.NET)         | Avalonia (C#/.NET)         |
|------------------|----------------------|-----------------------|----------------------------|
| 지원 OS          | Windows/Linux/macOS  | Windows               | Windows/Linux/macOS        |
| 의료기기 검증 실적 | 매우 높음             | 검증 중                | 제한적                     |
| DICOM 라이브러리 | DCMTK, GDCM          | fo‑dicom              | fo‑dicom                   |
| 이미지 처리 지원 | VTK/ITK 네이티브     | VTK.NET wrapper        | VTK.NET wrapper            |
| HW 연동          | 강점 (C++ 직접)       | P/Invoke 필요          | P/Invoke 필요              |
| 테스트 용이성    | 어려움 있음           | 매우 용이              | 적당                       |

✔️ **권장 아키텍처:**
C++ Core Engine + C# GUI (WPF) 하이브리드 구조  
→ GUI 생산성 + HW 인터페이스 성능 + 테스트/유지보수 용이

---

## 5. 🧰 핵심 라이브러리/도구

### DICOM 관련

| 라이브러리      | 언어      | 용도             |
|----------------|----------|------------------|
| DCMTK          | C++      | 표준 DICOM 서비스 |
| fo‑dicom       | C#/.NET  | .NET DICOM 서비스 |
| DVTK/Orthanc   | 여러      | 테스트/검증 환경 |

### 이미지 처리

- OpenCV (필터/전처리)
- VTK (렌더링/뷰어)
- ITK (고급 영상 처리)


---

## 6. 🧩 디바이스 연동 리서치

### 6.1 X‑ray Detector

#### 형태 및 기술

| 디바이스 유형                  | 설명                | 비고                |
|-------------------------------|---------------------|---------------------|
| Digital Flat Panel Detector (FPD) | 실시간 디지털 변환   | 16‑bit Raw, USB3/PCIe |
| Computed Radiography (CR)     | Phosphor plate 스캔 | 레거시 호환         |
| Wireless DR Panel             | Wi‑Fi 기반          | 이동성 강조         |

#### 전송 인터페이스

| 인터페이스   | 특징                        |
|-------------|-----------------------------|
| USB 3.x     | 높은 대역폭 (5Gbps), 범용    |
| PCIe        | 최고 속도, 복잡성 ↑         |
| GigE Vision | 네트워크 기반, 원거리 가능  |
| Camera Link | 산업용 전송 표준            |

✔️ **핵심 요구:** FPGA → DMA → Host 메모리 → 처리 파이프라인으로 끊김 없는 스트리밍 및 에러 복원 제공

### 6.2 HVG (High Voltage Generator)

#### 역할

- X‑ray 발생 전압 (kVp), 전류 (mA), 노출 시간 제어
- 실시간 상태 모니터링

#### 통신

- RS‑232/RS‑485
- Ethernet
- 맞춤 Command/Status Protocol

📌 **SW 측면 고려**

- 명령 큐잉
- Timeout/Retry
- 상태 콜백/Alarm 이벤트

### 6.3 AEC (Automatic Exposure Control)

- X‑ray 선량을 환자/조직 조건에 맞게 자동 조절
- 콘솔에서 자동/수동 전환 UI 제공
- Generator 및 Detector 로직과 Tight Integration

### 6.4 Table & Collimator

| 디바이스         | 역할                   |
|------------------|------------------------|
| X‑ray Table      | 환자 위치 조정, 모터화 |
| Collimator       | 빔 크기/형상 제어      |
| Position Sensors | 정확한 포지션 피드백   |

✔️ **포지셔닝/모션 제어는 실시간 제어·피드백 루프를 필요로 함**


---

## 7. 🛡️ 의료기기 규격 및 인허가

### 국제 규격 필수

| 규격                  | 핵심                  |
|-----------------------|-----------------------|
| IEC 62304             | SW Life Cycle         |
| ISO 14971             | 리스크 매니지먼트     |
| ISO 13485             | 품질경영시스템        |
| IEC 60601‑2‑54        | X‑ray 성능/안전       |
| IEC 62366‑1           | 사용성 공학           |
| DICOM PS3.x / IHE RAD TF | 표준 통신/워크플로우 |

**FDA MFDS 관점**

- SW 적합성 보고서
- DICOM 적합성 / IHE 워크플로우 제출 자료
- 사이버보안 가이드라인 준수


---

## 8. 📐 SW 아키텍처 및 데이터 플로우

### 8.1 Image Acquisition Pipeline

```
Detector ASIC  ──Bulk Data (USB/PCIe)──▶ DMA Ring Buffer
   │
   ▼
[Offset/Gain Correction]
   │
   ▼
[Defect Pixel Mapping]
   │
   ▼
[Scatter / Grid Correction]
   │
   ▼
[Window/Level & Display LUT]
   │
   ▼
[GUI 프리뷰 및 QC]
   │
   ▼
[DICOM Export (Study/Series)]
```

### 8.2 Workflow State Machine

Idle → Worklist Sync → Patient Select → Protocol Select → Position & Preview → Exposure Trigger → QC/Reject → MPPS Completed → PACS/Dose SR


---

## 9. 🧪 Test & 검증 전략

| 테스트 단계         | 목적                  |
|---------------------|-----------------------|
| Unit Test           | 함수/모듈 수준        |
| Integration Test    | SW/HW 인터페이스      |
| System Test         | End‑to‑End            |
| DICOM Conformance   | DICOM 서비스 적합성   |
| Usability Test      | IEC 62366 & UX        |
| Interoperability    | PACS/HIS/RIS          |

**Toolchains:**

- Orthanc + DVTK
- pytest + Google Test + xUnit
- FPGA Simulator Testbench (SV/Python)

---

## 10. 🔥 리스크 및 고려사항

| 리스크            | 영향              | 대안/완화                |
|-------------------|-------------------|--------------------------|
| USB3 Bottleneck   | 프리징/버퍼 언더런 | DMA 최적화, PCIe 고려    |
| SOUP 취약성       | 인증/안전 리스크   | 버전 고정 + 리스크 분석  |
| DICOM 호환성      | 상호운용 실패      | DVTK 멀티 벤더 시험      |
| GUI 응답성        | 불편한 UX          | async, 백그라운드 처리   |

---

## 11. 📌 Next Action Plan

✔️ **SW 플랫폼 확정**
   - C++ Core + WPF GUI PoC

✔️ **Protocol 정의**
   - FPGA ↔ Host (DMA, Command, Telemetry)

✔️ **Prototype 개발**
   - Detector Streams → Preview → DICOM Export

✔️ **테스트 환경 셋업**
   - Orthanc + DVTK + FPGA Simulator

✔️ **초기 인증 문서 템플릿 작성**
   - SRS/SDS/V&V Matrix

---

## 📚 참고 아티팩트 목록

- IEC 62304 / IEC 62366‑1 / IEC 60601‑2‑54
- DICOM PS3.x Standard
- IHE Radiology Technical Framework
- Qt for Medical Devices certification
- MFDS/ FDA Software Guidance

✔️ SW 플랫폼 확정
• C++ Core + WPF GUI PoC

✔️ Protocol 정의
• FPGA ↔ Host (DMA, Command, Telemetry)

✔️ Prototype 개발
• Detector Streams → Preview → DICOM Export

✔️ 테스트 환경 셋업
• Orthanc + DVTK + FPGA Simulator

✔️ 초기 인증 문서 템플릿 작성
• SRS/SDS/V&V Matrix

📚 참고 아티팩트 목록

IEC 62304 / IEC 62366‑1 / IEC 60601‑2‑54

DICOM PS3.x Standard

IHE Radiology Technical Framework

Qt for Medical Devices certification

MFDS/ FDA Software Guidance